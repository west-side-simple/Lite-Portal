-- скрапер-агрегатор TVS для загрузки локальных плейлистов пользователя (12.04.22)
-- Агрегатор листов 2.0 by West_Side
-- Плейлисты укладывать в директорию плеера work/iptv/
-- Copyright © 2020-2022 westSide
-- ## Переименовать каналы ##
local filter = {
	{'ZeeTV', 'Zee TV'},
	{'Время: далёкое и близкое', 'Время'},
	{'Живи', 'Живи!'},
	}
-- ##
	module('local_pls', package.seeall)
	local my_src_name = 'Local PLS'
	local function ProcessFilterTableLocal(t)
		if not type(t) == 'table' then return end
		for i = 1, #t do
			t[i].name = tvs_core.tvs_clear_double_space(t[i].name)
			for _, ff in ipairs(filter) do
				if (type(ff) == 'table' and t[i].name == ff[1]) then
					t[i].name = ff[2]
				end
			end
		end
	 return t
	end
	local function showMsg(str, color)
		local t = {text = str, color = color, showTime = 1000 * 5, id = 'channelName'}
		m_simpleTV.OSD.ShowMessageT(t)
	end
	function GetSettings()
	 return {name = my_src_name, sortname = '', scraper = '', m3u = 'out_' .. my_src_name .. '.m3u', logo = '..\\Channel\\logo\\Icons\\deniz.png', TypeSource = 1, TypeCoding = 1, DeleteM3U = 1, RefreshButton = 1, show_progress = 0, AutoBuild = 0, AutoBuildDay = {0, 0, 0, 0, 0, 0, 0}, LastStart = 0, TVS = {add = 1, FilterCH = 1, FilterGR = 1, GetGroup = 1, LogoTVG = 1}, STV = {add = 0, ExtFilter = 0, FilterCH = 0, FilterGR = 0, GetGroup = 1, HDGroup = 0, AutoSearch = 1, AutoSearchLogo =1, AutoNumber = 1, NumberM3U = 0, GetSettings = 1, NotDeleteCH = 0, TypeSkip = 0, TypeFind = 1, TypeMedia = 0, RemoveDupCH = 1}}
	end
	function GetVersion()
	 return 2, 'UTF-8'
	end
---wafee code from bad_filterUtf8.lua
local function is_bad_address(adr)
if adr==nil or adr=='' then return true end
local bad = { -- указываем часть адреса, который хотим исключить из списка загрузки
'85.187.244.111',
'/d2dw21aq0j0l5c',
--'wisp.cat/',
'/freedom_ua/',
'/9X6GLWKYX9RUWH/',
'/multf/',
'/FC_Barcelona/',
'/stream/musang',
'cdnua06.hls.tv',
'193.106.29.244',
'/KKTV01/',
'/KKTVNapoli/',
'/KissKissTV/',
'rihattv',
'/061df9d47a31d5ffeeee40bbf3333deb/',
'/Channel%-USTV%-AWS%-virginia%-1/',
'33news.org',
'62.67.13.53:1935/HealthTV/',
'/SUPERSIXLombardia/',
'/DEDbKgUYhF/',
'biztv.uz',
'185.132.132.19',
'saveukraine',
'tv.2222.one',
'/arhat.tv/',
'1plus1.video/sport/',
'uagit.tv/gittv.m3u8',
'/ntk/ntk.m3u8',
'strm.yandex.ru/kal/euronews',
'strm.yandex.ru/kal/echomoscow',
'strm.yandex.ru/kal/utv/',
'strm.yandex.ru/kal/vmru/',
'45.80.44.78:25001',
'62.32.67.187:1935',
'/hls/CH_R03_VSYUFA/',
'/hls/CH_R04_KUBAN24/',
'/hls/185386.m3u8',
'no%-comments',
'/hls/CH_R01_OTT_CT_BRYANSK_GORODSKOY/',
'/MTY0ODUyMTMzOQ/4726.m3u8',
'/V88EYWK93ZQKMQ/',
'cdnmg.secure.live',
'93.152.174.144:4000',
'37.187.28.95:2022',
'/1VGPHYLZTH/',
'/27d3f771f722037356f28ab60e1eb7db/',
'/4c0638123e05b9370674f3a7645374ef/',
'hronika_vojny',
'russia2.livetv.az',
'95.67.12.149:9115',
'46.174.83.66/Dom_Kino/',
'srv1.roshen.live',
'/Jfd85Hf/',
'JscDsPk1ZT',
'2xd64Ekang',
'6oC5wymbz0',
'7KL9tDxowe',
'FstOA66EYd',
'B54LdDuAtX',
'LMwgRJvRWU',
'LRIDvvUWs6',
'lzAEadAhky',
'1SiwVOHy67',
'RuVDoDiUM7',
'wyys6HE9Xb',
'nTyewZltmC',
'RnUcb8Fiyh',
'nq2UwPZ2xb',
'8CpMYEv9KS',
'pKoxLLa8mL',
'pKoxLLa8mL',
'kEtEkoO4o1',
'1N2AX2dCfV',
'/Mix2472WEB/5tr5seg/',
'/M3UCanales4/4fr9vich/',
'live.fluxhd.ru',
'bluecrabstv.do.am',
'200.24.159.179:8500',
'95.67.12.179:9003',
'194.15.225.98:8000',
'mycdn.video/docu/',
'mycdn.video/fresh/',
'mycdn.video/hit/',
'/shoptv.m3u8',
'/crabs/',
'/NgTVYqWGxR/',
'85.192.10.131',
'104c0d2277462a117ba608bec5675ed1',
'f34b3d2dc463990f4fd3e79b5c5fe4a5',
'185.10.211.10:50988',
'80.68.246.196:8080',
'78.109.104.240:8000',
'/SorRhM8284/jQs1T03740/',
'filmon.com/vr%-streams/',
'/0u5IOA5146/',
'/1cf2197a9f3b8ebc5f9f',
'/2XBPNFMZKED9RN/',
'/4HSPNN4AN899MH/',
'/62cfc21293b371478414',
'/6CBBEEKZV5CG3E/',
'/6VNmuJ684/',
'/7FHCJrZ8JX/',
'/91.126.141.201:1935',
'/9528/9528_264_live.m3u8',
'/aivaya/',
'/amagi_hls_data_xumo1212A',
'/Appavang/livestream/',
'/bezheck/',
'/btv/SWM/Animal_planet/',
'/btv/SWM/Sony/',
'/btv/SWM/SonyTurbo/',
'/btv/SWM/TLC/',
'/btv/SWM/TV1000Action',
'/CH_R04_UNIVER/',
'/content/40391/index.m3u8',
'/content/37493/index.m3u8',
'/content/38377/index.m3u8',
'/content/35676/index.m3u8',
'/content/37316/index.m3u8',
'/content/37353/index.m3u8',
'/content/37388/index.m3u8',
'/content/38710/index.m3u8',
'/content/38794/index.m3u8',
'/content/38798/index.m3u8',
'/content/40017/index.m3u8',
'/content/40108/index.m3u8',
'/content/40499/index.m3u8',
'/content/40502/index.m3u8',
'/content/40504/index.m3u8',
'/content/40515/index.m3u8',
'/content/40554/index.m3u8',
'/content/40800/index.m3u8',
'/content/40953/index.m3u8',
'/detskiy/multimania20/',
'/detskiy/ryzhiy_08/',
'/dv_tv/',
'/DWBRRCR6YPR5VL/',
'/EQb55kyG6J7678/nJsUEd2559/',
'/fwrGbX6x/',
'/gknhhWhJHh/',
'/GQ8C97G6JF/',
'/his/CH_D%-TV6',
'/his/CH_DMITRY%-TVHD',
'/hls/152922.m3u8',
'/hls/163343.m3u8',
'/hls/175764.m3u8',
'/hls/17592_4.m3u8',
'/hls/179807.m3u8',
'/hls/180204.m3u8',
'/hls/180960_480.m3u8',
'/hls/185417.m3u8',
'/hls/187484.m3u8',
'/hls/187824.m3u8',
'/hls/20206.m3u8',
'/hls/33226.m3u8',
'/hls/5346_480.m3u8',
'/hls/54105.m3u8',
'/hls/61358_480.m3u8',
'/hls/CH_R04_OTT_ECHOTV/',
'/hls/CH_EUROSPORT4K/',
'/hls/CH_EUROSPORT4K_HLS/',
'/hls/CH_GLAZAMITURISTA4K/',
'/hls/CH_LOVENATURE4K/',
'/hls/CH_LOVENATURE4K_HLS/',
'/hls/CH_R01_ALTES/',
'/hls/CH_R01_OTT_EKBTV_URAL_EKT/',
'/hls/CH_R01_OTT_SIB_BUL_TOLK',
'/hls/CH_R01_OTT_SIB_IRK_SEMERKA/',
'/hls/CH_R01_OTT_SIB_IRK_TIVICI/',
'/hls/CH_R01_OTT_SIB_KRSK_CENTRKRSN/',
'/hls/CH_R01_OTT_SIB_NSK_TSM/',
'/hls/CH_R01_OTT_STH_STAVR_INGUSHETIYA1/',
'/hls/CH_R01_OTT_STH_STAVR_KAVKAZ24/',
'/hls/CH_R01_TV43REGION/',
'/hls/CH_R01_TV43REGION/',
'/hls/CH_R02_MORDOVIY24/',
'/hls/CH_R02_MTVMIX/',
'/hls/CH_R02_OTT_5TV_URALIFORM_PERM/',
'/hls/CH_R03_OTT_STUDIO41/',
'/hls/CH_R03_OTT_VLG_CHR_ZIMA/',
'/hls/CH_R03_STB/',
'/hls/CH_R04_OTT_KURRU_URAL_KRG/',
'/hls/CH_R04_OTT_NOY24_URAL_NOY/',
'/hls/CH_R04_OTT_VLG_SAMARA_SKAT24/',
'/hls/CH_RUSSIANEXTREMEULTRA_HLS/',
'/hls/CH_RUSSIANILLUSION/',
'/hls/CH_TVXXI/',
'/hls/CH_ULLUSIONPLUS/',
'/hls/CH_ULTRAHDCINEMA_HLS/',
'/hls/CH_VSETVHD_HLS/',
'/hls/filmpremera/index.m3u8',
'/hls/MultimaniaRu/playlist.m3u8',
'/hls/tnt_md.m3u8',
'/hls/tuso_ua_mid/',
'/hls/vhstv/index.m3u8',
'/hls/vipcinemahd/index.m3u8',
'/hls_h0_clr_vos/',
'/live/300432/',
'/live/305240/',
'/lzIZuQ878/',
'/MCN6_MUSIC',
'/No_Name_HD/',
'/NOf3LO924/RLLju7988/',
'/powerturkhd',
'/ptica1/chunklist.m3u8',
'/rtmp_vestifm',
'/s5plus/',
'/steelbirdmusic',
'/udp/',
'/VDqwGcqQldH0859/',
'/z74gxyj3pn/',
'/ZXWFUS85YY8F4S/',
'100automoto.tv',
'103.194.169.171:8282',
'103.213.238.194:8080',
'104.149.153.238:8000',
'109.122.68.51:4000',
'109.194.62.29:8080',
'109.239.128.126:8080',
'118.47.168.157:8080',
'140.238.127.147/streams/9.m3u8',
'146065_master.m3u8',
'152.70.49.253:8080/channel/n70702de5/',
'159.224.182.177:8080',
'1637191689%-1637105289',
'1637218343%-1637131943',
'1637828010%-1637741610',
'1638423786%-1638337386',
'173945_master.m3u8',
'176.126.166.43:1935',
'176.222.164.72',
'176.222.164.73',
'176.222.187.146',
'176.222.187.146:80',
'176.222.190.71',
'176.222.190.72',
'185.129.1.242',
'185.156.179.234:8084',
'185.161.218.2',
'185.176.222.148',
'185.18.207.154:8080/kvn',
'185.185.252.75:8000',
'185.228.135.48/tv_gagra_tv/',
'185.228.135.48:8080',
'185.230.140.20',
'185.234.111.37:8880',
'185.29.255.187:8001',
'185.52.77.67:8080',
'185.74.7.220:8080',
'185.96.176.139:90',
'185.97.150.19:10082',
'185.97.150.19:8082',
'188.113.190.12',
'188.113.190.14',
'188.232.102.173:9981',
'188.242.114.187:34040',
'188.247.191.234',
'188.40.68.167',
'188.40.68.167/russia/mir_seriala',
'188.40.68.167/russia/mtv_hits',
'188.40.68.167/russia/paramount_comedy/',
'188.43.116.250',
'192.166.144.111:8008',
'193.150.102.92:',
'193.169.178.29',
'193.30.240.7',
'193.33.240.8',
'193.33.88.172',
'194.146.190.241:4000',
'194.158.218.123:8880/SvetloeTV_GL',
'194.190.78.91:8080/siesta/',
'194.190.88.34:1935',
'194.246.92.196',
'194.50.51.34',
'194.9.27.164:8108',
'194.9.27.164:8109',
'195.110.6.15:8000',
'195.154.242.229',
'195.154.242.229:3000',
'195.158.220.35:8000',
'195.189.60.253',
'195.222.7.26:7001',
'195.245.97.133:8800',
'195.49.206.244:90',
'195.9.195.19:8001',
'1D30CCF5D10539D845901A084EFDB660AD3593E8',
'205ceb711830cb1db1dd6f2679970d2019b',
'207.110.52.61:8080',
'212.193.179.142:81',
'212.26.129.4',
'212.73.81.237:8000',
'212.76.27.27',
'212.76.27.29',
'212.76.27.29:80',
'212.76.29.26',
'212.76.29.27',
'213.151.233.20:8000',
'213.174.23.59:8080',
'213.226.137.133:81',
'213.226.137.140:81',
'22d476851052d092901eeb8374ab146d',
'25277e3cb8084b3c402716ca774a495c',
'264710/cbsn_hlsprod_2/',
'31.128.159.41:8080',
'31.128.159.41:8080',
'31.130.127.10:10000',
'31.131.191.7:8000',
'31.134.132.245:8080',
'31.173.178.110:8004',
'31.173.178.110:8104',
'31.202.57.42:4022',
'31.220.41.86:8081',
'31.220.41.86:8081',
'31.40.148.98:8000',
'37.17.12.119',
'37.17.12.124:8901',
'37.17.14.149:890',
'37.17.14.149:8905',
'37.17.14.149:8909',
'37.17.14.149:8912',
'37.99.5.234',
'37.99.5.235',
'4012907628e2948eeb12ac151371ca1cbb0/',
'423ae8a5177b0a059394fb5b30d361a0',
'42AT0uYeL1xaTygYW4INVI2NaD6BQR82QrRdGrR',
'45.80.44.79:25001',
'45.80.44.79:25002',
'45.80.44.93:25001',
'45.80.44.93:25011',
'45.80.44.93:25022',
'46.174.83.66/NTV_Hit/',
'46.254.241.94:455',
'46.34.209.242',
'46.34.209.243',
'46.34.209.244',
'46.63.0.9:8001',
'46.63.0.9:8004',
'5.101.0.202:8001',
'5.255.90.184:2000',
'5.53.118.226:61103/play/a01q',
'5.53.118.226:61103/play/a01r',
'5.53.118.226:61104/play/a013',
'5.53.118.226:61107/play/a005',
'5.53.118.226:61108/play/a00u',
'50.7.172.58:8081',
'51.15.0.141:88',
'51.15.176.84',
'51.210.199',
'51.210.199.24',
'5656.ga',
'572587b8c545c53006c7aba229ca8f93',
'5db1ab4f970be.streamlock.net:1935',
'5m8nyjr8nct.smil',
'68.235.35.243:1935',
'74F5EB24725C911/',
'77.235.18.154:1935',
'77.83.117.60:8888',
'770F956CBA2439CA93FCE277BDE4BB9DE593866C',
'78.58.133.179:28000',
'80.245.117.66:11375',
'80.249.92.172:8081',
'80.251.50.18:8004',
'80.76.245.198:12284',
'82.209.218.116:8181',
'83.220.173.73:8088',
'83.97.111.172:4022',
'84.201.197.58:9981',
'86.57.174.73:14000',
'86.57.174.73:14002',
'86.57.178.105',
'86.57.178.105:10823',
'86.57.178.105:8011',
'87.126.155.253:4000',
'87.247.44.24',
'87.247.44.25',
'87.247.44.26',
'87.252.229.252:8081',
'87.252.229.252:8083',
'89.208.68.16:1',
'8c1e4e62753e33941811436858346bb4d4ba8959d',
'91.132.60.82:4000',
'91.185.3.218:4000',
'91.192.168.242:9091',
'91.192.168.251',
'91.201.177.2:8010',
'91.210.24.70:88',
'91.221.201.2:7006',
'91.221.201.2:7100',
'91.231.200.2:9500',
'91.234.255.18:8000',
'91.235.165.120:8000',
'91.235.69.230',
'91.237.126.50:9001',
'91.238.24.248',
'91.240.83.247',
'92.119.251.239',
'92.245.103.126:1935',
'92.43.140.249',
'93.100.195.249:8080/test',
'93.157.62.180',
'93.189.224.117:9021',
'93.189.224.118:9030/peretz',
'93.84.85.122',
'94.101.225.142:9981',
'94.155.204.102:4000',
'94.250.61.10:8000',
'95.141.128.163:8004',
'95.141.143.88:18000',
'95.163.25.103',
'95.215.111.230:8082',
'95.46.208.8:26258',
'95.46.208.8:26259',
'95.52.173.220:81',
'95.52.173.220:82',
'95.67.103.251',
'95.67.12.189',
'95.67.12.94',
'95.67.13.103',
'95.67.21.141',
'95.67.21.70',
'95.67.21.77',
'95.67.57.12',
'95.67.70.108',
'95.67.77.58',
'?token=Do8PlhKER0',
'a3569458063%-s26881.cdn.ngenix.net/hls/russia_hd',
'ad60f9233a3e0dab655bde868789cadc',
'adultiptv.net',
'adyotvonline.com/e90tv/e90tvlive',
'akamaihd.net/i/sbshdlive_1@829515/',
'aw3bw9r75lo',
'base.samotlor.tv:2936',
'bblackcaribbean',
'blivenyc.com',
'btv.md',
'cbctvlive.flashmediacast',
'cdn.nexttvnet.ru',
'cdn.ngenix.net/open/_definst_/TVRain_noaudio/',
'cdn.tv.ti.ru',
'cdn3.invivo.bg/',
'cdn77.org',
'cdnups.tk/%d+/',
'cdnvideo.ru/dumatv/',
'cdnvideo.ru/migtv/',
'cdnvideo.ru/mycdn0539860594/',
'cdnvideo.ru/siesta/',
'cdnvideo.ru/topshop/',
'chdrstatic.com',
'city.bg',
'clients.apsny.camera/tv_gal_tv_hd_onlin',
'cliptv.az',
'cloud.ch/sstvlinear/',
'content/34251',
'cosmonova.net.ua/hls/7d7tv_ua_hi/',
'cosmonova.net.ua/hls/central%-poltava_ua_hi/',
'cosmonova.net.ua/hls/kanaldom_ua_hi/',
'cosmonova.net.ua/hls/kdrtrk_ua_mid/',
'cosmonova.net.ua/hls/mart_ua_hi/',
'cosmonova.net.ua/hls/televsesvit_ua_hi/',
'cosmonova.net.ua/hls/ua%-culture_ua_mid/',
'cosmonova.net.ua/hls/vinnychchyna_ua_hi/',
'cosmonova.net.ua/hls/vitatv_ua_hi/',
'd2e1asnsl7br7b.cloudfront.net',
'DADF1907265BA39C877CA7D15E500EBF',
'djing.com',
'dmitry%-tv.ml',
'duhnet.tv',
'elbru.tk',
'elsalvadordigital.com',
'erostv.sdp',
'eyJ1c2VySWQiOiJpcHR2aW5UU04ifQ',
'eyJ1c2VySWQiOiJzZXJnZWp0c24ifQ', 
'fenixplustv.xyz',
'filmtv.zapto.org:8050',
'FleKsIPtv/QdsrWfghjkZxs23Li/',
'fmxXpwqiUt8irC',
'forumstatic.ru',
'fwryalta',
'gcdn.co/streams/1410_287/',
'gcdn.co/streams/1410_290/',
'globecast.tv',
'goodgame.ru/hls/6147',
'hithd.camsh.orsk.ru',
'hmara.tv',
'hostingradio.ru',
'idata.uz',
'insyscd.net',
'iptvdc.com',
'iptvmate.net',
'itv.uz',
'ivebeta.publika.md',
'jewelleria.de/hlslive/test/site.m3u8',
'kaztrk.kz/regional/oskementv/',
'kb.catcast.tv',
'kglive.asia',
'lanet.tv',
'leonovtv/test1',
'live.streams.ovh',
'live.stv24.tv',
'live/hlsGS/',
'live/smil:mayak',
'livesports24.online',
'livetv.az/russia/komediya',
'luxnet.ua/luxstudio/',
'mmg.ooo/live/sd.stream/',
'moldtelecom.md',
'morescreens.com/mts%-a2/',
'morescreens.com/mts%-a3/',
'my.teleelevidenie.com',
'mytvchannel.ru/hamdan24/',
'myvideocontent.ru/hls2/user74350/',
'neterra.tv',
'netrack.ru/hls/ecotv',
'onair%-radio.eu',
'opoja.tv',
'otcnet.cdnvideo.ru/kinosem/',
'otcnet.ru/kinosem/',
'otcnet.ru/siesta/',
'ott.tricolor.tv',
'ottolok.net',
'otttv.pw',
--'persik.by',
'pfqw4zdfpaxhe5i.cmle',
'player.obozrevatel.com',
'playout395.livestreamingcdn.com',
'podryad.net',
'powernet.com.ru',
'prd.dlive.tv/hls/live/cybervybezradio.m3u8',
'prd.dlive.tv/hls/live/happyradio.m3u8',
'prd.dlive.tv/hls/live/tistv.m3u8',
'prd.dlive.tv/hls/live/vagmofm.m3u8',
'proofix.ru/7tv%-live/',
'prosto.tv',
'QmusicNL.m3u8',
'qnNUnXdwRyvUqPLo',
'radiorelax.ua',
'radiovan.fm',
'rai.it',
'redtraffic.xyz',
'ROSTIK_TV',
'rtmp.one.by:1499',
'rtmp://89.107.113.89:1935',
'rtmp://92.255.180.64',
'rtmp://94.190.79.226/',
'rtmp://tvsever.ru:1937',
'rustam_charyev',
'shingaliptv.ru.com',
'SilenceTV',
'sinclairstoryline.com',
'singularcdn.net.br',
'siza.site',
'skyfolk.mk',
'smashmalta.com',
'sochi.camera:8080',
'sonus.fm:1935',
'space:8080/tvoetv',
'sqcfso60x0_Priuralye24',
'sr%-vk.online',
'srvif.com',
'stream.efir24.tv:1935',
'stream.tv7.kz',
'stream.tvtap',
'stream2.hardlife.tv:8134/hls-live/hlsGS',
'streamer1.podolsknet.ru',
'streaming.bitonlive.net:8080',
'streamlock.net/9080/',
'streamlock.net/tltvweb/',
'streamlock.net/visionmusica/',
'streams.ovh',
'strm.yandex.ru/kal/diving',
'strm.yandex.ru/kal/dw',
'strm.yandex.ru/kal/france24',
'strm.yandex.ru/kal/rbc',
'strm.yandex.ru/kal/skazkizayki',
'strm.yandex.ru/kal/sovkino',
'strm.yandex.ru/kal/sovmult',
'strm.yandex.ru/kal/zagorod',
'sweet.tv',
'tosnotv.ru',
'tv.cdn.xsg.ge',
'tvmatic.net',
'tvstitch.com',
'utvedge/',
'visionip.tv',
'vivat.live',
'web%-event.com.ua',
'webvideocore.net',
'wIdcWVrjWlw4Qql6',
'yeninesiliptv',
------------------------------
'$limetvhd=7d7',
'$limetvhd=arctica24',
'$limetvhd=camera%-online',
'$limetvhd=nasa_tv_media',
'$limetvhd=france24',
'$limetvhd=nasa_tv',
'$limetvhd=sovietmovs',
'$limetvhd=cna_eu',
'$limetvhd=radio%-orsk',
'$limetvhd=kab.tv',
'$limetvhd=travelxp',
'$limetvhd=sport_uz',
'$limetvhd=365day',
'$limetvhd=adventure',
'$limetvhd=adventurehd',
'$limetvhd=android_info',
'$limetvhd=anekdot',
'$limetvhd=animalshd',
'$limetvhd=avto24',
'$limetvhd=avtoplus',
'$limetvhd=barelylegal',
'$limetvhd=blokbaster',
'$limetvhd=bluehustler',
'$limetvhd=boectv',
'$limetvhd=bokstv',
'$limetvhd=country',
'$limetvhd=detskiy',
'$limetvhd=dikiy',
'$limetvhd=dizitv',
'$limetvhd=dorama',
'$limetvhd=drive',
'$limetvhd=eda',
'$limetvhd=edahd',
'$limetvhd=eromania',
'$limetvhd=etv',
'$limetvhd=eurekahd',
'$limetvhd=eurokino',
'$limetvhd=exotica',
'$limetvhd=film%-families',
'$limetvhd=film%-hit',
'$limetvhd=film%-premiere',
'$limetvhd=film%-watching',
'$limetvhd=footbal',
'$limetvhd=football1',
'$limetvhd=football1%-hd',
'$limetvhd=football2',
'$limetvhd=football2%-hd',
'$limetvhd=football3',
'$limetvhd=football3%-hd',
'$limetvhd=footbolniyhd',
'$limetvhd=gagsnetwork',
'$limetvhd=ginger%-surd',
'$limetvhd=gingerhd',
'$limetvhd=hit',
'$limetvhd=hobbies',
'$limetvhd=hokkeyniy',
'$limetvhd=homejivotnie',
'$limetvhd=illuzionplus',
'$limetvhd=india',
'$limetvhd=insight',
'$limetvhd=jivi',
'$limetvhd=k_kino',
'$limetvhd=kamedi',
'$limetvhd=khlhd',
'$limetvhd=khltv',
'$limetvhd=kinocomedia',
'$limetvhd=kinomenu',
'$limetvhd=kinomix',
'$limetvhd=kinopokaz',
'$limetvhd=kinosat',
'$limetvhd=kinoseria',
'$limetvhd=kinoujas',
'$limetvhd=konniy',
'$limetvhd=kuhnya',
'$limetvhd=livenature',
'$limetvhd=m1global',
'$limetvhd=male',
'$limetvhd=male%-movie',
'$limetvhd=malish',
'$limetvhd=match.arena',
'$limetvhd=match.igra',
'$limetvhd=matchhd',
'$limetvhd=motosport',
'$limetvhd=multikhd',
'$limetvhd=multimania',
'$limetvhd=mytheme',
'$limetvhd=nashe_n_kino',
'$limetvhd=nashemuzskoe',
'$limetvhd=nashfootbal',
'$limetvhd=nashfootbolhd',
'$limetvhd=nashpokaz',
'$limetvhd=nashsport',
'$limetvhd=nostalgiya',
'$limetvhd=ntvpravo',
'$limetvhd=ntvserial',
'$limetvhd=ntvstyle',
'$limetvhd=oceantv',
'$limetvhd=ohota_i_ribalka',
'$limetvhd=ohotahd',
'$limetvhd=ohotnik',
'$limetvhd=ohotnikhd',
'$limetvhd=orujie',
'$limetvhd=prolubov',
'$limetvhd=psihologia',
'$limetvhd=redlips',
'$limetvhd=retro',
'$limetvhd=ribalkahd',
'$limetvhd=rjd',
'$limetvhd=rodnoe',
'$limetvhd=rossiahd',
'$limetvhd=rtg',
'$limetvhd=rtghd',
'$limetvhd=rusilluzion',
'$limetvhd=rusnight',
'$limetvhd=shalunhd',
'$limetvhd=shottv',
'$limetvhd=skazka',
'$limetvhd=sportivniyhd',
'$limetvhd=stskids',
'$limetvhd=taina',
'$limetvhd=theater',
'$limetvhd=tochkaotriva',
'$limetvhd=tonus',
'$limetvhd=tourist_eyes',
'$limetvhd=trash',
'$limetvhd=tvm-tv',
'$limetvhd=usadba',
'$limetvhd=voprosi-otveti',
'$limetvhd=whoiswho',
'$limetvhd=zal_suda',
'$limetvhd=zdorovoe',
'$limetvhd=zeetv',
'$limetvhd=zoo',
'$limetvhd=zoopark',
'$limetvhd=zvezdaplus',

--'$limetvhd=tojikiston',
--'$limetvhd=sinamotv',
--'$limetvhd=safinatv',
--'$limetvhd=region04',
--'$limetvhd=bohoristontv',
--'$limetvhd=neftekamsk',
--'$limetvhd=jahonnamo',
--'$limetvhd=varzishtv',
--'$limetvhd=yoshlar',
--'$limetvhd=toshkent',
--'$limetvhd=uzbekistan24',
--'$limetvhd=navo',
--'$limetvhd=mahalla',
--'$limetvhd=madaniyat_va_marifat',
--'$limetvhd=ictimai_az',
--'$limetvhd=dunyo_boylab',
--'$limetvhd=cbc_az',
--'$limetvhd=bolajon',

--[[
'$limetvhd=5kanal',
'$limetvhd=1kanal',
'$limetvhd=match',
'$limetvhd=mir',
'$limetvhd=ntv',
'$limetvhd=pyatnica',
'$limetvhd=rentv',
'$limetvhd=rossia1',
'$limetvhd=russiak',
'$limetvhd=sts',
'$limetvhd=stslove',
'$limetvhd=super',
'$limetvhd=tnt',
'$limetvhd=tnt4',
'$limetvhd=tv3',
'$limetvhd=tvc',
'$limetvhd=zvezda',
]]
------------------------------
'$telkoln=',
'$telkoln=rodnoe',
'$telkoln=indijskoe',
'$telkoln=kinokomediya',
'$telkoln=kinomiks',
'$telkoln=kinopremera',
'$telkoln=kinosvidanie.html',
'$telkoln=kinosemya.html',
'$telkoln=kinoseriya.html',
'$telkoln=kinouzhas.html',
'$telkoln=kinokhit.html',
'$telkoln=nashe',
'$telkoln=lyubimoe',
'$telkoln=cinema.html',
'$telkoln=dorama.html',
'$telkoln=kinosat.html',
'$telkoln=nst.html',
'$telkoln=russkij%-detektiv.html',
'$telkoln=russkij%-roman.html',
'$telkoln=russkij%-bestseller.html',
'$vipontvnet=amctv.html',
'$vipontvnet=cinema.html',
'$vipontvnet=kino%-tvtv.html',
'$vipontvnet=nsttv.html',
'$vipontvnet=russkiy%-bestsellertv.html',
'$vipontvnet=super.html',
'$vipontvnet=doramatv.html',
'$vipontvnet=kinosat.html',
'$vipontvnet=russkiy%-detektivtv.html',
------------------------------
'/mdrm/CH_BOOMERANG/',
'/mdrm/CH_C03_ANIMALPLANETHD/',
'/mdrm/CH_C05_DISCOVERYCHANNELHD/',
'/mdrm/CH_IDXTRAHD/',
'/mdrm/CH_DISCOVERYINVESTIGATION/',
'/mdrm/CH_HGTVHD/',
'/mdrm/CH_C02_EUROSPORTHD/',
'/mdrm/CH_EUROSPORT2HD/',
'/mdrm/CH_EUROSPORT_GHD/',
'/mdrm/CH_EUROSPORT2/',
'/mdrm/CH_EUROSPORT_G/',
'/mdrm/CH_C04_TLCHD/',
'/mdrm/CH_C05_FOODHD/',
'/mdrm/CH_TRAVELCHANNELHD/',
'/mdrm/CH_CARTOON_NETWORKSHD/',
'/mdrm/CH_NHLTVHD/',
'/mdrm/CH_DEUTSCHEWELLE/',
'/mdrm/CH_NHKWORLDJAPANHD/',
'/mdrm/CH_CNN_INTERNATIONAL/',
'/mdrm/CH_BBCWORLDNEWS/',
'/mdrm/CH_FRANCE24HD/',
'/mdrm/CH_EURONEWS/',
'/mdrm/CH_JIMJAM/',
} 
  for i=1, #bad do
    if string.match(adr, bad[i]) then
      return true
    end  
  end
 return false
end

local function LoadFromDisc()
-- путь к директории плейлистов
	local path = m_simpleTV.Common.GetMainPath(2) .. 'work/iptv/'
--
	local t = m_simpleTV.Common.DirectoryEntryList(path,'*.m3u;*.m3u8','Files|NoDot|NoDotDot','Name|IgnoreCase|DirsFirst')
	local answer, txtstr = '', ''
    if t~=nil then
	for i=1,#t do
	local file = io.open(path .. m_simpleTV.Common.UTF8ToMultiByte(t[i].fileName,1251), 'r')
	local answer1 = file:read('*a')
	file:close()
	if answer1 and answer1:match('^#EXTM3U') then
		answer1 = answer1:gsub('%#EXTVLCOPT.-\n','')
		answer1 = answer1:gsub('#EXTINF','# \n#EXTINF')
		answer1 = answer1 .. '\n# \n'
        answer = answer1 .. answer
		txtstr = txtstr .. ' загрузка плейлиста ' .. i .. ' из ' .. #t .. ' - ' .. t[i].fileName .. ': удачно\n'
		else
		txtstr = txtstr .. ' загрузка плейлиста ' .. i .. ' из ' .. #t .. ' - ' .. t[i].fileName .. ': ошибка\n'
        end
	i=i+1
	end
    end
--debug_in_file(txtstr .. '\n' .. answer,'c://1/1.txt')
		m_simpleTV.OSD.ShowMessageT({imageParam = 'vSizeFactor="1" src="' .. m_simpleTV.Common.GetMainPath(2) .. './work/Channel/logo/icons/deniz.png"', text = txtstr, color = ARGB(255, 127, 63, 255), showTime = 1000 * 10})
        local t, i = {}, 1

            for w in answer:gmatch('%#EXTINF:.-%# ') do

                local title = w:match(',(.-)\n')
                local adr = w:match('\n(http.-)\n') or w:match('\n(rtmp.-)\n')
                local logo = w:match('tvg%-logo="(.-)"')
                    if not adr or not title then break end
                t[i] = {}
                t[i].name = title
                t[i].address = adr
                t[i].group = w:match('group%-title="([^"]+)') or 'Новые каналы'
				if logo
				then
                 t[i].logo = logo:gsub('https?://iptvx%.one/picons/%.%./','./work/')
				else
				 logo = './work/Channel/logo/icons/deniz.png'
				end

                i = i + 1
			end

            if i == 1 then return end
			
			local t1, j = {}, 1
			for i = 1, #t do
            if not is_bad_address(t[i].address) then
			t1[j] = t[i]
			j=j+1
			end
			end

---			
			local hash, tab = {}, {}
			for i = 1, #t1 do
				if not hash[t1[i].address]
				then
					tab[#tab + 1] = t1[i]
					hash[t1[i].address] = true
				end
			end

			if #tab == 0 then return end

     return tab
    end

	function GetList(UpdateID, m3u_file)
			if not UpdateID then return end
			if not m3u_file then return end
			if not TVSources_var.tmp.source[UpdateID] then return end
--		local outm3u,m3u5,m3u4,m3u3,m3u2,m3u1
		local Source = TVSources_var.tmp.source[UpdateID]

				local t_pls = LoadFromDisc()

			if not t_pls then
				m_simpleTV.OSD.ShowMessageT({text = Source.name .. ' ошибка загрузки плейлиста'
											, color = ARGB(255, 255, 100, 0)
											, showTime = 1000 * 5
											, id = 'channelName'})
			 return
			end

		m_simpleTV.OSD.ShowMessageT({text = Source.name .. ' (' .. #t_pls .. ')'
									, color = ARGB(255, 155, 255, 155)
									, showTime = 1000 * 5
									, id = 'channelName'})
		t_pls = ProcessFilterTableLocal(t_pls)
		local m3ustr = tvs_core.ProcessFilterTable(UpdateID, Source, t_pls)
		local handle = io.open(m3u_file, 'w+')
			if not handle then return end
		handle:write(m3ustr)
		handle:close()
	 return 'ok'
	end
-- debug_in_file(#t_pls .. '\n')